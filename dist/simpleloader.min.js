(function(e,t){function f(t,n,i){var s=o[t];if(!s){s={url:t,deferred:e.ajax(e.extend({url:u+t+a},n))};o[t]=s}if(i){if(s[r].state()=="resolved"){i();return}e.when(s[r]).done(function(){i()})}}function l(t){var i=t.shift();n["get"+c(i.url)](i.url);e.when(o[i.url][r]).done(function(){i[r].resolve();t.length&&l(t)})}function c(e){var t=e.split(".").pop(),n="";switch(t){case"js":n=i;break;case"css":n="CSS";break;case"jpg":n=s;break;case"png":n=s;break;case"gif":n=s;break;default:n=i}return n}function h(n){var r=[],i=[],s=[],o=function(t){e.isArray(t)?e.merge(i,t):i.push(t)};n.load&&o(n.load);n.test&&n.yep&&o(n.yep);!n.test&&n.nope&&o(n.nope);e.each(i,function(t,n){var i=e.Deferred();r.push(i);s.push({url:n,deferred:i})});l(s);e.when.apply(t,r).done(function(){n.complete&&n.complete()})}var n,r="deferred",i="Script",s="Image",o={},u="",a="";n={getScript:function(e,t){f(e,{dataType:"script",cache:!0},t)},getCSS:function(t,n){f(t,{cache:!0},n);e.when(o[t][r]).done(function(){e("<link>").appendTo(e("head")).attr({type:"text/css",rel:"stylesheet"}).attr("href",u+t+a)})},getImage:function(e,t){f(e,{},t)},setBaseUrl:function(e){u=e},setSufix:function(e){a=e}};e.extend(h,n);e.wk=e.wk||{};e.wk.load=h})(jQuery||Zepto,window);